@page "/"
@page "/login"
@layout Layout.EmptyLayout

<!-- ===================== OVERALL PAGE WRAPPER ===================== -->
<div class="login-page">

    <!-- ===================== MAIN CONTENT CONTAINER ===================== -->
    <div class="login-container">

        <!-- ===================== LEFT: LOGIN CARD ===================== -->
        <div class="login-card">

            <!-- Inner wrapper so we can center everything inside the white panel -->
            <div class="login-card-inner">

                <!-- ========== LOGO AREA ========== -->
                <div class="logo-placeholder">
                    <img src="/images/Final_logo-removebg-preview.png" alt="MedFlow Logo" class="logo-image" />
                </div>

                <!-- ========== LOGIN TITLE (OPTIONAL) ========== -->
                <h2 class="login-title">Sign in to MedFlow</h2>

                <!-- ========== ERROR MESSAGE AREA ========== -->
                <!-- Shown when the entered credentials are incorrect -->
                @if (!string.IsNullOrWhiteSpace(ErrorMessage))
                {
                    <div class="login-error-message">@ErrorMessage</div>
                }

                <!-- ========== LOGIN FORM ========== -->
                <EditForm Model="this" OnValidSubmit="HandleLogin">
                    <DataAnnotationsValidator />

                    <!-- ----- USERNAME / EMAIL INPUT ROW ----- -->
                    <div class="input-group">
                        <!-- Input control for username/email -->
                        <InputText class="input-field" @bind-Value="UserName" placeholder="Username or Email" />

                        <!-- Icon on the right side of the input -->
                        <span class="input-icon">
                            <!-- Simple user icon using Unicode; replace with SVG if you prefer -->
                            &#128100;
                        </span>
                    </div>

                    <!-- ----- PASSWORD INPUT ROW ----- -->
                    <div class="input-group">
                        <!-- Input control for password -->
                        <InputText class="input-field" @bind-Value="Password" type="password" placeholder="Password" />

                        <!-- Lock icon on the right side -->
                        <span class="input-icon">
                            &#128274;
                        </span>
                    </div>

                    <!-- ========== LOGIN BUTTON ========== -->
                    <button type="submit" class="login-button">LOGIN</button>
                </EditForm>

                <!-- ========== EXTRA LINKS AREA ========== -->
                <div class="login-links">
                    <a href="/forgot-password" class="login-link">Forgot your password?</a>
                    <a href="/create-account" class="login-link">Create Account?</a>
                </div>

                <!-- ========== FOOTER TEXT ========== -->
                <div class="login-footer-text">
                    <span>Terms of Use.</span>
                    <span>Privacy Policy.</span>
                </div>
            </div>
        </div>

        <!-- ===================== RIGHT: INFORMATION PANEL ===================== -->
        <div class="info-panel">

            <!-- Inner wrapper so we can center the text nicely in the green panel -->
            <div class="info-panel-inner">
                <!-- Big heading text, matching the design -->
                <h1 class="info-title">Integrated Clinical and Revenue Cycle Management System</h1>

                <!-- Description paragraph under the main title -->
                <p class="info-description">
                    MedFlow brings healthcare and transactions together in one smooth experience. Manage patient care,
                    records, and payments with just a few clicks.
                </p>
            </div>
        </div>
    </div>
</div>

@code {
    // ===================== BACKING FIELDS / PROPERTIES =====================
    // Property bound to the username/email input
    public string? UserName { get; set; }

    // Property bound to the password input
    public string? Password { get; set; }

    // Holds a message when login fails (kept if you want to show inline text later)
    public string? ErrorMessage { get; set; }

    [Inject]
    private NavigationManager Navigation { get; set; } = default!;

    // JS runtime used to show simple alert dialogs (e.g., invalid credentials)
    [Inject]
    private IJSRuntime JsRuntime { get; set; } = default!;

    // ===================== EVENT HANDLERS =====================
    // This method is called when the form is submitted successfully
    private void HandleLogin()
    {
        // Clear any existing error message first
        ErrorMessage = null;

        // Temporary hard-coded credentials while database auth is not yet wired
        // Valid login only when username == "admin" and password == "12345".
        var isValid = string.Equals(UserName, "admin", StringComparison.OrdinalIgnoreCase)
                      && Password == "12345";

        if (!isValid)
        {
            // Show a simple dialog when credentials are invalid
            JsRuntime.InvokeVoidAsync("alert", "Invalid Credentials!");
            return;
        }

        // Navigate to the dashboard when the credentials are correct
        Navigation.NavigateTo("/dashboard");
    }
}
