@page "/"
@page "/login"

<!-- ===================== OVERALL PAGE WRAPPER ===================== -->
<div class="login-page">

    <!-- ===================== MAIN CONTENT CONTAINER ===================== -->
    <div class="login-container">

        <!-- ===================== LEFT: LOGIN CARD ===================== -->
        <div class="login-card">

            <!-- Inner wrapper so we can center everything inside the white panel -->
            <div class="login-card-inner">

                <!-- ========== LOGO AREA ========== -->
                <div class="logo-placeholder">
                    <img src="/images/Final_logo-removebg-preview.png" alt="MedFlow Logo" class="logo-image" />
                </div>

                <!-- ========== LOGIN TITLE (OPTIONAL) ========== -->
                <h2 class="login-title">Sign in to MedFlow</h2>

                <!-- ========== LOGIN FORM (SIMPLIFIED) ========== -->
                <!-- We use plain inputs and a button with @onclick to ensure the handler always runs. -->

                <!-- ----- USERNAME / EMAIL INPUT ROW ----- -->
                <div class="input-group">
                    <InputText class="input-field" @bind-Value="UserName" placeholder="Username or Email" />

                    <span class="input-icon">
                        &#128100;
                    </span>
                </div>

                <!-- ----- PASSWORD INPUT ROW ----- -->
                <div class="input-group">
                    <InputText class="input-field" @bind-Value="Password" type="password" placeholder="Password" />

                    <span class="input-icon">
                        &#128274;
                    </span>
                </div>

                <!-- ========== LOGIN BUTTON ========== -->
                <button type="button" class="login-button" @onclick="HandleLogin">LOGIN</button>

                <!-- ========== EXTRA LINKS AREA ========== -->
                <div class="login-links">
                    <a href="/forgot-password" class="login-link">Forgot your password?</a>
                    <a href="/create-account" class="login-link">Create Account?</a>
                </div>

                <!-- ========== FOOTER TEXT ========== -->
                <div class="login-footer-text">
                    <span>Terms of Use.</span>
                    <span>Privacy Policy.</span>
                </div>
            </div>
        </div>

        <!-- ===================== RIGHT: INFORMATION PANEL ===================== -->
        <div class="info-panel">

            <!-- Inner wrapper so we can center the text nicely in the green panel -->
            <div class="info-panel-inner">
                <!-- Big heading text, matching the design -->
                <h1 class="info-title">Integrated Clinical and Revenue Cycle Management System</h1>

                <!-- Description paragraph under the main title -->
                <p class="info-description">
                    MedFlow brings healthcare and transactions together in one smooth experience. Manage patient care,
                    records, and payments with just a few clicks.
                </p>
            </div>
        </div>
    </div>
</div>

@code {
    // ===================== BACKING FIELDS / PROPERTIES =====================
    // Property bound to the username/email input
    public string? UserName { get; set; }

    // Property bound to the password input
    public string? Password { get; set; }

    [Inject]
    private NavigationManager Navigation { get; set; } = default!;

    [Inject]
    private IJSRuntime JsRuntime { get; set; } = default!;

    // ===================== EVENT HANDLERS =====================
    // This method is called when the user clicks LOGIN
    private async Task HandleLogin()
    {

        // Temporary hard-coded credentials while database auth is not yet wired
        var isAdmin = string.Equals(UserName, "admin", StringComparison.OrdinalIgnoreCase)
                      && Password == "12345";

        var isNurse = string.Equals(UserName, "nurse", StringComparison.OrdinalIgnoreCase)
                      && Password == "12345";

        var isDoctor = string.Equals(UserName, "doctor", StringComparison.OrdinalIgnoreCase)
                       && Password == "12345";

        var isBilling = string.Equals(UserName, "Billing", StringComparison.OrdinalIgnoreCase)
                        && Password == "12345";

        var isInventory = string.Equals(UserName, "inventory", StringComparison.OrdinalIgnoreCase)
                           && Password == "12345";

        if (isAdmin)
        {
            Navigation.NavigateTo("/dashboard");
            return;
        }

        if (isNurse)
        {
            Navigation.NavigateTo("/nurse-dashboard");
            return;
        }

        if (isDoctor)
        {
            Navigation.NavigateTo("/doctor-dashboard");
            return;
        }

        if (isBilling)
        {
            Navigation.NavigateTo("/billing-dashboard");
            return;
        }

        if (isInventory)
        {
            Navigation.NavigateTo("/inventory-dashboard");
            return;
        }

        // When credentials are invalid, show a browser dialog
        await JsRuntime.InvokeVoidAsync("alert", "Invalid credentials. Please try again.");
    }
}
